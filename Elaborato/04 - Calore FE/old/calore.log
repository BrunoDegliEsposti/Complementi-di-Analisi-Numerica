-- FreeFem++ v  4.200001 (date Sat, Jun 08, 2019  6:08:22 PM git v4.2.1)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : real h = 0.1;
    2 : real deltat = 0.1;
    3 : real tfinal = 1;
    4 : real theta = 0.5;
    5 :
    6 : border circle(t = 0, 2*pi) {
    7 :         x = cos(t);
    8 :         y = sin(t);
    9 :         label = 1;
   10 : }
   11 :
   12 : func real f(real t) {
   13 :         return (4*t+x^2+y^2+2)/(t+1)^2;
   14 : }
   15 :
   16 : func real uexact(real t) {
   17 :         return (-x^2-y^2+2)/(t+1);
   18 : }
   19 :
   20 : int Nsub = round(2*pi/h);
   21 : mesh Th = buildmesh(circle(Nsub));
   22 : fespace Vh(Th, P2);
   23 : Vh uh, fh, e;
   24 : varf getM(u,v) = int2d(Th)(u*v);
   25 : varf getA(u,v) = int2d(Th)(dx(u)*dx(v)+dy(u)*dy(v)) + int1d(Th,1)(2*u*v);
   26 : varf getf(u,v) = int2d(Th)(fh*v);
   27 : matrix M = getM(Vh,Vh);
   28 : matrix A = getA(Vh,Vh);
   29 : matrix S = M + deltat*theta*A;
   30 : /* https://github.com/FreeFem/FreeFem-sources/issues/102 */
   31 : matrix T = 1*M - deltat*(1-theta)*A;
   32 : set(S, solver=Cholesky, factorize=1);
   33 : //set(S, solver=CG, eps=1e-8);
   34 :
   35 : real[int] vs = 0:40;
   36 : vs *= 0.05;
   37 : uh = -x^2-y^2+2;
   38 : real t = 0;
   39 : while (t < tfinal - 1e-8) {
   40 :         //plot(uh, wait=1, fill=1, viso=vs, cmm="t = " + t);
   41 :         real[int] uh2 = T*uh[];
   42 :         fh = theta*f(t+deltat) + (1-theta)*f(t);
   43 :         real[int] fterm = getf(0,Vh);
   44 :         uh2 += deltat*fterm;
   45 :         uh[] = S^-1*uh2;
   46 :         t += deltat;
   47 : }
   48 : //plot(uh, wait=1, fill=1, viso=vs, cmm="t = " + t);
   49 : e = uh-uexact(t);
   50 : plot(e, wait=1);
   51 : cout << sqrt(int2d(Th)(e^2+dx(e)*dx(e)+dy(e)*dy(e))) << endl;
   52 :  sizestack + 1024 =3336  ( 2312 )
 
  --  mesh:  Nb of Triangles =    703, Nb of Vertices 384
  SkyLineMatrix: size pL/pU: 1470 65396 65396 moy=44.4871
0.00447136
times: compile 0.077s, execution 0.809s,  mpirank:0
 ######## We forget of deleting   -6 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3312,  size :424464 mpirank: 0
Ok: Normal End
 try getConsole C:\Users\Bruno\Desktop\Elaborato CAN\Calore FE\calore.edp
